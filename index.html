<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>SVGã‚¹ãƒ†ãƒƒã‚«ãƒ¼å·¥æˆ¿ â€” Single HTML</title>
<meta name="description" content="ãƒ†ã‚­ã‚¹ãƒˆï¼‹çµµæ–‡å­—ã§ä¸¸ã‚¹ãƒ†ãƒƒã‚«ãƒ¼SVGã‚’ç”Ÿæˆã€PNGæ›¸ãå‡ºã—ã‚‚ã§ãã‚‹å˜ä¸€HTMLã‚¢ãƒ—ãƒª">
<style>
  :root{
    --bg:#0e1015; --panel:#12141b; --card:rgba(255,255,255,.05);
    --border:rgba(255,255,255,.12); --text:#e9ecf5; --muted:#aeb3c2; --acc:#7aa7ff;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text); background:
      radial-gradient(1200px 600px at 10% -10%, #1b2240 0%, #0e1015 55%, #0a0b0e 100%);
    font-family: ui-sans-serif, system-ui, -apple-system, "Hiragino Kaku Gothic ProN",
      "Noto Sans JP","Segoe UI", Roboto, "Helvetica Neue", Arial,
      "Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji";
    display:grid; grid-template-rows:auto 1fr auto; min-height:100dvh;
  }
  header{
    padding:18px 22px; display:flex; justify-content:space-between; align-items:center;
    border-bottom:1px solid var(--border); backdrop-filter: blur(10px);
  }
  header .title{ display:flex; align-items:center; gap:12px; }
  .title .logo{
    width:32px; height:32px; border-radius:50%;
    background: conic-gradient(from 210deg, #7aa7ff, #8ef0c7, #febc6b, #7aa7ff);
    box-shadow: 0 0 0 1px rgba(255,255,255,.3) inset, 0 6px 18px rgba(122,167,255,.35);
  }
  .title h1{ font-size:16px; margin:0; letter-spacing:.3px }
  .pill{
    font-size:12px; color:#cfd3dc; padding:6px 10px; border-radius:999px;
    background: rgba(255,255,255,.06); border:1px solid var(--border);
  }
  main{
    padding:20px; display:grid; gap:18px; grid-template-columns: 1.1fr 1fr;
  }
  @media (max-width:1000px){ main{ grid-template-columns:1fr; } }
  .card{
    background: var(--card); border:1px solid var(--border); border-radius:18px; padding:16px;
    box-shadow: 0 10px 30px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.05);
    backdrop-filter: blur(12px);
  }
  .card h2{ margin:4px 0 12px; font-size:18px; color:#f1f4fb }
  label{ font-size:12px; color:var(--muted); display:block; margin:10px 0 6px }
  input[type="text"], input[type="number"], input[type="color"], select, textarea{
    width:100%; color:var(--text); background: rgba(255,255,255,.04);
    border:1px solid var(--border); border-radius:12px; padding:10px 12px; outline:none;
  }
  textarea{ min-height:84px; resize:vertical }
  input[type="range"]{ width:100% }
  .row{ display:grid; grid-template-columns:1fr 1fr; gap:10px }
  .btns{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px }
  button{
    border:1px solid var(--border);
    background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    color:var(--text); border-radius:12px; padding:10px 14px; cursor:pointer;
  }
  button:hover{ border-color: rgba(255,255,255,.25) }
  .primary{ border-color: rgba(122,167,255,.6); box-shadow: 0 0 0 1px rgba(122,167,255,.25) inset }
  .muted{ color:var(--muted) }
  .hint{ font-size:12px; color:var(--muted); margin-top:6px }
  /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ ï¼ˆãƒã‚§ãƒƒã‚«ãƒ¼ã§é€éè¡¨ç¾ï¼‰ */
  .preview{
    border-radius:16px; overflow:hidden; position:relative; border:1px solid var(--border);
    background:
      conic-gradient(from 45deg, #1a1d25 0 25%, #12141b 0 50%) 0 0/22px 22px;
  }
  .preview-inner{ padding:16px }
  svg{ width:100%; height:auto; display:block }
  /* ã‚¹ãƒ†ãƒƒã‚«ãƒ¼å¤–å‘¨ã®ãƒ€ãƒƒã‚·ãƒ¥ï¼ˆã‚«ãƒƒãƒˆãƒ©ã‚¤ãƒ³ï¼‰è¡¨ç¤ºç”¨ */
  .legend{ display:flex; gap:8px; align-items:center; font-size:12px; color:#cfd3dc; }
  footer{
    padding:16px 22px; display:flex; justify-content:space-between; align-items:center;
    border-top:1px solid var(--border); color:var(--muted);
  }
  .kbd{
    padding:2px 6px; border:1px solid var(--border); border-radius:6px; font-size:12px;
    background: rgba(255,255,255,.05)
  }
</style>
</head>
<body>
  <header>
    <div class="title">
      <div class="logo" aria-hidden="true"></div>
      <h1>SVGã‚¹ãƒ†ãƒƒã‚«ãƒ¼å·¥æˆ¿</h1>
      <span class="pill">å˜ä¸€HTML / ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸è¦</span>
    </div>
    <div class="legend">
      <span class="pill">SVGâ†’PNGæ›¸ãå‡ºã—</span>
    </div>
  </header>

  <main>
    <!-- å·¦ï¼šã‚¨ãƒ‡ã‚£ã‚¿ -->
    <section class="card" aria-label="ã‚¨ãƒ‡ã‚£ã‚¿">
      <h2>ğŸ¨ ãƒ‡ã‚¶ã‚¤ãƒ³</h2>
      <div class="row">
        <div>
          <label>çµµæ–‡å­—</label>
          <input id="emoji" type="text" placeholder="ä¾‹ï¼‰ğŸ¡ / ğŸˆ / ğŸŒ¿" maxlength="8" value="ğŸ¡">
        </div>
        <div>
          <label>ãƒ†ã‚­ã‚¹ãƒˆ</label>
          <input id="title" type="text" placeholder="ä¾‹ï¼‰DANGO">
        </div>
      </div>

      <div class="row">
        <div>
          <label>çµµæ–‡å­—ã‚µã‚¤ã‚ºï¼ˆ%ï¼‰</label>
          <input id="emojiSize" type="range" min="40" max="140" value="90">
        </div>
        <div>
          <label>æ–‡å­—ã‚µã‚¤ã‚ºï¼ˆ%ï¼‰</label>
          <input id="textSize" type="range" min="40" max="140" value="80">
        </div>
      </div>

      <div class="row">
        <div>
          <label>ãƒ•ã‚©ãƒ³ãƒˆ</label>
          <select id="font">
            <option value='"Noto Sans JP", system-ui, sans-serif'>Noto Sans JPï¼ˆã‚´ã‚·ãƒƒã‚¯ï¼‰</option>
            <option value='"Hiragino Mincho ProN","Yu Mincho", serif'>æ˜æœ</option>
            <option value='"SF Pro Display","Segoe UI", system-ui, sans-serif'>SF/Segoe</option>
            <option value='"M PLUS 1p",system-ui,sans-serif'>M PLUS 1p</option>
          </select>
        </div>
        <div>
          <label>å­—é–“ï¼ˆletter-spacingï¼‰</label>
          <input id="letter" type="range" min="-2" max="12" value="2">
        </div>
      </div>

      <div class="row">
        <div>
          <label>ãƒ™ãƒ¼ã‚¹è‰²â‘ </label>
          <input id="c1" type="color" value="#7aa7ff">
        </div>
        <div>
          <label>ãƒ™ãƒ¼ã‚¹è‰²â‘¡ï¼ˆã‚°ãƒ©ãƒ‡ï¼‰</label>
          <input id="c2" type="color" value="#8ef0c7">
        </div>
      </div>

      <div class="row">
        <div>
          <label>æ–‡å­—è‰²</label>
          <input id="tcolor" type="color" value="#ffffff">
        </div>
        <div>
          <label>å¤–å‘¨ãƒ©ã‚¤ãƒ³ï¼ˆç™½ï¼‰å¤ªã•</label>
          <input id="outline" type="range" min="0" max="40" value="24">
        </div>
      </div>

      <div class="row">
        <div>
          <label>ã‚µã‚¤ã‚ºï¼ˆpxï¼‰</label>
          <input id="size" type="number" min="256" max="2048" step="64" value="1024">
        </div>
        <div>
          <label>PNGã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆÃ—ï¼‰</label>
          <input id="scale" type="number" min="1" max="8" value="2">
        </div>
      </div>

      <div class="row">
        <div>
          <label>ã‚«ãƒƒãƒˆãƒ©ã‚¤ãƒ³è¡¨ç¤º</label>
          <select id="cut">
            <option value="on" selected>è¡¨ç¤ºã™ã‚‹</option>
            <option value="off">è¡¨ç¤ºã—ãªã„</option>
          </select>
        </div>
        <div>
          <label>å½±ï¼ˆãƒ‰ãƒ­ãƒƒãƒ—ã‚·ãƒ£ãƒ‰ã‚¦ï¼‰</label>
          <select id="shadow">
            <option value="soft" selected>ã‚„ã‚ã‚‰ã‹</option>
            <option value="none">ãªã—</option>
          </select>
        </div>
      </div>

      <label>ç½²åï¼ˆå³ä¸‹/ä»»æ„ï¼‰</label>
      <input id="credit" type="text" placeholder="@shimarinï¼ˆç©ºæ¬„ã§ã‚ªãƒ•ï¼‰">

      <div class="btns">
        <button id="random">ãƒ ãƒ¼ãƒ‰ã§é…è‰²ã‚¬ãƒãƒ£</button>
        <button id="render" class="primary">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°</button>
        <button id="downloadPNG">â¬‡ï¸ PNGãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        <button id="copyPNG">ğŸ“‹ PNGã‚³ãƒ”ãƒ¼</button>
        <button id="downloadSVG">â¬‡ï¸ SVGãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
      </div>
      <div class="hint">ãƒ’ãƒ³ãƒˆï¼šãƒ†ã‚­ã‚¹ãƒˆã¯çŸ­ã‚ãŒæ˜ ãˆã‚„ã™ã„ã€‚è¡Œã‚’å¢—ã‚„ã—ãŸã„æ™‚ã¯ <span class="kbd">Space</span> ã‚„ <span class="kbd">-</span> ã§ãƒªã‚ºãƒ ã‚’ä½œã‚‹ã®ã‚‚â—</div>
    </section>

    <!-- å³ï¼šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ -->
    <section class="card" aria-label="ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">
      <h2>ğŸ§ª ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</h2>
      <div class="preview">
        <div class="preview-inner">
          <svg id="sticker" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="ã‚¹ãƒ†ãƒƒã‚«ãƒ¼ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼">
            <defs>
              <linearGradient id="grad" x1="0" x2="1" y1="0" y2="1">
                <stop offset="0%" stop-color="#7aa7ff"/>
                <stop offset="100%" stop-color="#8ef0c7"/>
              </linearGradient>
              <filter id="drop" x="-50%" y="-50%" width="200%" height="200%">
                <feGaussianBlur in="SourceAlpha" stdDeviation="18" result="blur"/>
                <feOffset in="blur" dx="0" dy="16" result="off"/>
                <feColorMatrix in="off" type="matrix"
                  values="0 0 0 0 0
                          0 0 0 0 0
                          0 0 0 0 0
                          0 0 0 .35 0" result="shadow"/>
                <feBlend in="SourceGraphic" in2="shadow" mode="normal"/>
              </filter>
              <!-- ã†ã£ã™ã‚‰ãƒã‚¤ã‚º -->
              <filter id="noise">
                <feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" stitchTiles="stitch"/>
                <feColorMatrix type="saturate" values="0"/>
                <feComponentTransfer>
                  <feFuncA type="table" tableValues="0 0 .08 0"/>
                </feComponentTransfer>
              </filter>
            </defs>

            <g id="g-sticker" filter="url(#drop)">
              <circle id="base" cx="512" cy="512" r="410" fill="url(#grad)"/>
              <circle id="halo" cx="512" cy="512" r="410" fill="none" stroke="#fff" stroke-width="24" opacity=".85"/>
              <g filter="url(#noise)">
                <rect x="102" y="102" width="820" height="820" fill="#000" opacity=".06"/>
              </g>
            </g>

            <g id="g-content" text-anchor="middle" dominant-baseline="middle"
               font-family='"Noto Sans JP","SF Pro Display","Segoe UI",system-ui,"Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji"'
               fill="#fff">
              <text id="emojiText" x="512" y="430" font-size="420">ğŸ¡</text>
              <text id="mainText" x="512" y="650" font-size="200" letter-spacing="2">DANGO</text>
            </g>

            <g id="g-credit" font-size="36" fill="#ffffff" opacity=".9"
               font-family='"Noto Sans JP","SF Pro Display","Segoe UI",system-ui'>
              <text id="creditText" x="760" y="840" text-anchor="end"></text>
            </g>

            <g id="g-cut" opacity=".8">
              <circle cx="512" cy="512" r="450" fill="none" stroke="#ffffff" stroke-width="2" stroke-dasharray="10 10"/>
            </g>
          </svg>
        </div>
      </div>
      <div class="hint">é€éèƒŒæ™¯ã®ãŸã‚ã€PNGã¯å‘¨å›²ãŒé€æ˜ã«ãªã‚Šã¾ã™ï¼ˆä¸¸ã ã‘æ®‹ã‚‹ã‚ˆï¼‰ã€‚</div>
    </section>
  </main>

  <footer>
    <div>Made with â¤ï¸ / å˜ä¸€HTMLãƒ»å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãªã—</div>
    <div class="muted">ä¿å­˜ã—ãŸè¨­å®šã¯ãƒ–ãƒ©ã‚¦ã‚¶ã«è‡ªå‹•ä¿å­˜ï¼ˆlocalStorageï¼‰</div>
  </footer>

<script>
(() => {
  const $ = s => document.querySelector(s);
  // UIè¦ç´ 
  const el = {
    emoji: $('#emoji'), title: $('#title'),
    emojiSize: $('#emojiSize'), textSize: $('#textSize'),
    font: $('#font'), letter: $('#letter'),
    c1: $('#c1'), c2: $('#c2'), tcolor: $('#tcolor'),
    outline: $('#outline'), size: $('#size'), scale: $('#scale'),
    cut: $('#cut'), shadow: $('#shadow'),
    credit: $('#credit'),
    // Buttons
    random: $('#random'), render: $('#render'),
    dlPNG: $('#downloadPNG'), copyPNG: $('#copyPNG'), dlSVG: $('#downloadSVG'),
    // SVG nodes
    svg: $('#sticker'),
    grad: $('#grad'), base: $('#base'), halo: $('#halo'),
    gCut: $('#g-cut'), gSticker: $('#g-sticker'), drop: $('#drop'),
    emojiText: $('#emojiText'), mainText: $('#mainText'),
    creditText: $('#creditText'),
  };

  // åˆæœŸãƒ†ã‚­ã‚¹ãƒˆ
  el.title.value = 'DANGO';
  // è¨­å®šã®ä¿å­˜/å¾©å…ƒ
  const persistKeys = ['emoji','title','emojiSize','textSize','font','letter','c1','c2','tcolor','outline','size','scale','cut','shadow','credit'];
  function save(){
    const data = {};
    persistKeys.forEach(k => data[k] = el[k].value);
    localStorage.setItem('sticker.settings', JSON.stringify(data));
  }
  function load(){
    try{
      const data = JSON.parse(localStorage.getItem('sticker.settings')||'{}');
      persistKeys.forEach(k => { if(data[k]!==undefined) el[k].value = data[k]; });
    }catch(e){}
  }

  // é…è‰²ã‚¬ãƒãƒ£ï¼ˆãƒ ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ï¼šè½ã¡ç€ãâ†’å…ƒæ°—ï¼‰
  function randomPalette(){
    const mood = Math.random(); // 0-1
    const h = Math.round(210 - mood*150); // ãƒ–ãƒ«ãƒ¼â†’ã‚¤ã‚¨ãƒ­ãƒ¼
    const c1 = `hsl(${h} 80% 65%)`;
    const c2 = `hsl(${(h+35)%360} 85% 55%)`;
    el.c1.value = rgbToHex(cssColorToRgb(c1));
    el.c2.value = rgbToHex(cssColorToRgb(c2));
  }
  function cssColorToRgb(css){
    // ä¸€æ™‚è¦ç´ ã§è¨ˆç®—
    const tmp = document.createElement('div');
    tmp.style.color = css; document.body.appendChild(tmp);
    const rgb = getComputedStyle(tmp).color; document.body.removeChild(tmp);
    const m = rgb.match(/(\d+),\s*(\d+),\s*(\d+)/);
    return {r:+m[1], g:+m[2], b:+m[3]};
  }
  function rgbToHex({r,g,b}){
    const h = n => ('0' + n.toString(16)).slice(-2);
    return `#${h(r)}${h(g)}${h(b)}`;
  }

  // SVGæ›´æ–°
  function update(){
    // ã‚µã‚¤ã‚ºé–¢é€£
    const S = clamp(+el.size.value || 1024, 256, 2048);
    el.svg.setAttribute('width', S);
    el.svg.setAttribute('height', S);

    // ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    el.grad.children[0].setAttribute('stop-color', el.c1.value);
    el.grad.children[1].setAttribute('stop-color', el.c2.value);

    // ãƒ™ãƒ¼ã‚¹å††ãƒ»å¤–å‘¨
    const outline = +el.outline.value;
    el.halo.setAttribute('stroke-width', outline);
    el.base.setAttribute('fill', 'url(#grad)');

    // å½±
    if(el.shadow.value === 'none'){
      el.gSticker.removeAttribute('filter');
    }else{
      el.gSticker.setAttribute('filter', 'url(#drop)');
    }

    // ä¸­å¤®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
    const tColor = el.tcolor.value;
    const fontFamily = el.font.value;
    const letter = +el.letter.value;

    // çµµæ–‡å­—
    const emoji = (el.emoji.value || 'ğŸ™‚').slice(0,8);
    el.emojiText.textContent = emoji;
    el.emojiText.setAttribute('fill', tColor);
    el.emojiText.setAttribute('font-size', Math.round(420 * (+el.emojiSize.value/100)));
    el.emojiText.setAttribute('font-family', `"Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji",${fontFamily}`);

    // ãƒ†ã‚­ã‚¹ãƒˆ
    const text = (el.title.value || '').trim() || 'STICKER';
    el.mainText.textContent = text;
    el.mainText.setAttribute('fill', tColor);
    el.mainText.setAttribute('font-family', fontFamily);
    el.mainText.setAttribute('font-size', Math.round(200 * (+el.textSize.value/100)));
    el.mainText.setAttribute('letter-spacing', letter);

    // ç½²å
    const credit = (el.credit.value || '').trim();
    el.creditText.textContent = credit;

    // ã‚«ãƒƒãƒˆãƒ©ã‚¤ãƒ³
    if(el.cut.value === 'off'){ el.gCut.setAttribute('opacity', '0'); }
    else { el.gCut.setAttribute('opacity', '.8'); }

    save();
  }

  // PNGå‡ºåŠ›ï¼ˆSVGâ†’Canvasâ†’PNGï¼‰
  function exportPNG(copy=false){
    const scale = clamp(+el.scale.value || 2, 1, 8);
    const S = clamp(+el.size.value || 1024, 256, 2048);
    const svgString = getSVGString();
    const blob = new Blob([svgString], {type:'image/svg+xml'});
    const url = URL.createObjectURL(blob);
    const img = new Image();
    img.onload = () => {
      const canvas = document.createElement('canvas');
      canvas.width = S*scale; canvas.height = S*scale;
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.drawImage(img, 0,0, canvas.width, canvas.height);
      URL.revokeObjectURL(url);
      canvas.toBlob(async (pngBlob) => {
        if(copy){
          try{
            await navigator.clipboard.write([new ClipboardItem({'image/png': pngBlob})]);
            alert('PNGã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ âœ¨');
          }catch(e){ alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆãƒ–ãƒ©ã‚¦ã‚¶æœªå¯¾å¿œã®å¯èƒ½æ€§ï¼‰'); }
        }else{
          const a = document.createElement('a');
          a.href = URL.createObjectURL(pngBlob);
          a.download = 'sticker.png';
          a.click();
          URL.revokeObjectURL(a.href);
        }
      }, 'image/png', 0.95);
    };
    img.src = url;
  }

  // SVGä¿å­˜
  function exportSVG(){
    const svgString = getSVGString();
    const blob = new Blob([svgString], {type:'image/svg+xml'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'sticker.svg';
    a.click();
    URL.revokeObjectURL(a.href);
  }

  function getSVGString(){
    // ç¾åœ¨ã®SVGã‚’ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºï¼ˆXMLå®£è¨€ä»˜ãï¼‰
    update(); // å¿µã®ãŸã‚åæ˜ 
    const s = new XMLSerializer().serializeToString(el.svg);
    return `<?xml version="1.0" encoding="UTF-8"?>\n` + s;
  }

  function clamp(n, a, b){ return Math.max(a, Math.min(b, n)); }

  // ã‚¤ãƒ™ãƒ³ãƒˆ
  const inputs = ['input','change'];
  inputs.forEach(ev=>{
    ['emoji','title','emojiSize','textSize','font','letter','c1','c2','tcolor','outline','size','scale','cut','shadow','credit']
      .forEach(id => el[id].addEventListener(ev, update));
  });
  el.random.addEventListener('click', () => { randomPalette(); update(); });
  el.render.addEventListener('click', update);
  el.dlPNG.addEventListener('click', ()=> exportPNG(false));
  el.copyPNG.addEventListener('click', ()=> exportPNG(true));
  el.dlSVG.addEventListener('click', exportSVG);

  // åˆæœŸ
  load(); update();
})();
</script>
</body>
</html>
